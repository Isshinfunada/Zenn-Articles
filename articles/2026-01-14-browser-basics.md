---
title: "「作って学ぶブラウザのしくみ」学習記録：Webの仕組みからセキュリティまで"
type: "tech"
emoji: "🌐"
topics:
  - "ブラウザ"
  - "技術書"
  - "HTTP"
  - "レンダリング"
  - "セキュリティ"
published: false
---
# 今日やったこと

「作って学ぶブラウザのしくみ」の第1章を読み、ブラウザの基本的な仕組みについておさらいしました。ブラウザのコアとなる3つの役割（Webクライアント、レンダリングエンジン、JavaScriptエンジン）と、それらを支えるストレージ、マルチプロセスアーキテクチャ、セキュリティ機構について理解を深めました。

# 今日学んだこと

## Webの基礎とプロトコル

- **Webとインターネットの違い**: Webはインターネット上で提供される情報共有システムの一つです。インターネットはTCP/IPプロトコルを用いてコンピュータが相互に通信するネットワークであり、Webはその上で動作する情報共有の仕組みです。
- **HTTPプロトコル**: ブラウザが情報を取得するために使用されるプロトコルはHTTPです。本書には「HTTPはテキストベースのプロトコルなので、人間が容易に読むことができます。」と書いてあったが、それはHTTP1.1の時代の話で、現在主流のHTTP/2以降ではバイナリベースに変更されています
- 参考: [HTTPのバージョンについてまとめ #テキストベースからバイナリベースへ](https://qiita.com/hirooka0527/items/13767855358f83db5e02#%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%99%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%83%99%E3%83%BC%E3%82%B9%E3%81%B8)

## レンダリングとDOM

- **レンダリングの役割**: ブラウザの文脈では、HTMLやCSSなどのリソースを解釈して描画することを指します。これによりWebサイトが描画されます。
- **DOMツリーの構造**: HTMLは文字列ソースコードから、まずトークンに分割され、その後DOM（ドキュメントオブジェクトモデル）ツリーと呼ばれる木構造へと解析されます。DOMツリーは、JavaScriptなどのスクリプト言語からHTMLのコンテンツを操作可能にするデータ構造です。
- **ノードインターフェース**: ノードインターフェースには12種類あり、実務上よく触るのは Element/Text/Comment/Document などです。特にエレメントインターフェースがタグに対応して継承される形で実装されます。

## CSSとレイアウト

- **CSSOMの役割**: CSSも文字列からトークンに分割され、CSSOM（CSSオブジェクトモデル）という木構造を作成することで解釈されます。
- **レイアウトツリー**: ブラウザがWebページを表示するためにHTMLとCSSの情報を用いて作成する内部的なデータ構造です。DOMツリーとCSSOMの情報から作られます。それを基にレイアウト計算を実施します。

## JavaScriptの実行とブラウザAPI

- **JavaScriptの解析**: JavaScriptは文字列からトークンに分割され、抽象構文木（AST）と呼ばれる木構造を生成することで解析されます。
- **DOM API**: JavaScriptはブラウザ上でHTMLやCSSの操作を行うことが可能であり、この機能はDOM APIと呼ばれます。DOM APIはJavaScript言語自体の仕様とは独立して存在します。
- **ブラウザAPI**: DOM APIのほかにも、Fetch APIなど様々なブラウザAPIが存在します。

## ストレージとキャッシュ

- **クッキー**: 主にセッション管理やトラッキングに使用され、サーバとクライアント間で自動的に送受信されます。
- **Web Storage API**: ローカルストレージとセッションストレージがあり、どちらもキー/バリュー形式でデータを保存します。セッションストレージはタブが閉じられるとデータが削除される点が異なります。
- **ブラウザキャッシュ**: リソースをキャッシュし、再度リクエストされた際にネットワークダウンロードを省略することで速度を向上させます。

## マルチプロセスアーキテクチャ

- **プロセスの分離**: ブラウザは複数のプロセス（ブラウザプロセスとレンダラプロセス）上で動作することが多く、この設計はマルチプロセスアーキテクチャと呼ばれます。
- **セキュリティのための分離**: レンダラプロセスはHTML、CSS、JavaScriptの解釈と描画を行い、悪意のあるサイトからの攻撃を防ぐために、信頼できないリソースを扱うプロセスとしてブラウザプロセスから分離されています。メモリ空間が分離されているため、攻撃者のコードはレンダラプロセスで動いていても、ブラウザプロセスのメモリにアクセスできません。
- **iOS の特殊性**: iOS上のブラウザアプリはレンダリングエンジンとしてWebKitの使用が義務付けられてきました。ただし、近年は（地域・条件付きで）代替エンジンを認める方向の変更が進んでいます。
- 参考: [Apple、日本でのiOSにおける変更を発表](https://www.apple.com/jp/newsroom/2025/12/apple-announces-changes-to-ios-in-japan/)

## セキュリティ機構

- **サイト分離**: 異なるサイトのリソースを別々のプロセスで実行することで相互干渉を防ぐセキュリティ機構です。SpectreやMeltdownといったプロセッサーセキュリティの脆弱性が見つかって以降、特に注目されるようになりました。
- **同一生成元ポリシー（SOP）**: 異なるオリジン間のリソースへのアクセスを制限するセキュリティ機構であり、クロスサイトスクリプティング（XSS）やクロスサイトリクエストフォージェリ（CSRF）などの攻撃を軽減します。
- **CORS**: 同一生成元ポリシーによって制限されるクロスオリジンへのリクエストを許可するための仕組みです。HTTPヘッダを使用してサーバがどのオリジンからのリクエストを許可するかを指定します。
- **CSP**: Webページがロードするリソースのソースを制御し、XSSなどのセキュリティリスクを軽減するために利用されます。

# 次にやること

第2章以降で、実際にブラウザを実装しながらこれらの仕組みをより深く理解していく予定です。特に、HTTPリクエストの送信、HTMLのトークン化とDOM構築、レンダリングエンジンの実装など、コアとなる機能の実装を学んでいきます。
